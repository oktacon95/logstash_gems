<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Code coverage for Logstash-filter-c2server out all</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script src='./assets/0.10.2/application.js' type='text/javascript'></script>    
    <link href='./assets/0.10.2/application.css' media='screen, projection, print' rel='stylesheet' type='text/css'>
    <link rel="shortcut icon" type="image/png" href="./assets/0.10.2/favicon_green.png" />
    <link rel="icon" type="image/png" href="./assets/0.10.2/favicon.png" />
  </head>
  
  <body>
    <div id="loading">
      <img src="./assets/0.10.2/loading.gif" alt="loading"/>
    </div>
    <div id="wrapper" style="display:none;">
      <div class="timestamp">Generated <abbr class="timeago" title="2018-08-07T07:39:30Z">2018-08-07T07:39:30Z</abbr></div>
      <ul class="group_tabs"></ul>

      <div id="content">
        <div class="file_list_container" id="AllFiles">
  <h2>
    <span class="group_name">All Files</span>
    (<span class="covered_percent"><span class="green">90.44%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         6.6
       </span>
    </span> hits/line)
  </h2>
  <a name="AllFiles"></a>
  <div>
    <b>1</b> files in total.
    <b>136</b> relevant lines. 
    <span class="green"><b>123</b> lines covered</span> and
    <span class="red"><b>13</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#be665d61a9b5ce36796e0d6c3101f29f0535c08a" class="src_link" title="lib/logstash/filters/c2server_out_all.rb">lib/logstash/filters/c2server_out_all.rb</a></td>
        <td class="green strong">90.44 %</td>
        <td>319</td>
        <td>136</td>
        <td>123</td>
        <td>13</td>
        <td>6.6</td>
      </tr>
      
    </tbody>
  </table>
</div>


        
      </div>
    
      <div id="footer">
        Generated by <a href="http://github.com/colszowka/simplecov">simplecov</a> v0.16.1 
        and simplecov-html v0.10.2<br/>
        using RSpec
      </div>
    
      <div class="source_files">
      
        <div class="source_table" id="be665d61a9b5ce36796e0d6c3101f29f0535c08a">
  <div class="header">
    <h3>lib/logstash/filters/c2server_out_all.rb</h3>
    <h4><span class="green">90.44 %</span> covered</h4>
    <div>
      <b>136</b> relevant lines. 
      <span class="green"><b>123</b> lines covered</span> and
      <span class="red"><b>13</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby"># filter for c2 server out file (but the one with the naming context in the filename -- has date information included!)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require &quot;logstash/filters/base&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">require &quot;logstash/namespace&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">class LogStash::Filters::C2Server_OUT_ALL &lt; LogStash::Filters::Base</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  config_name &quot;c2server_out_all&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  # New plugins should start life at milestone 1.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  milestone 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  public </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  def register</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    # nothing to do</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end # def register</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  public </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def getLoglevel(loglevel, event)</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="19">
          <span class="hits">30</span>
          
          <code class="ruby">	case loglevel</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="20">
          <span class="hits">30</span>
          
          <code class="ruby">		when &quot;S&quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">		  return &quot;startstop&quot;</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="22">
          <span class="hits">28</span>
          
          <code class="ruby">		when &quot;C&quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="23">
          <span class="hits">2</span>
          
          <code class="ruby">		  return &quot;critical&quot;</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="24">
          <span class="hits">26</span>
          
          <code class="ruby">		when &quot;E&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">		  return &quot;error&quot;</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="26">
          <span class="hits">25</span>
          
          <code class="ruby">		when &quot;W&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">		  return &quot;warning&quot;</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="28">
          <span class="hits">24</span>
          
          <code class="ruby">		when &quot;N&quot;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="29">
          <span class="hits">5</span>
          
          <code class="ruby">		  return &quot;notice&quot;</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="30">
          <span class="hits">19</span>
          
          <code class="ruby">		when &quot;I&quot;</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="31">
          <span class="hits">15</span>
          
          <code class="ruby">		  return &quot;info&quot;</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="32">
          <span class="hits">4</span>
          
          <code class="ruby">		when &quot;D&quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="33">
          <span class="hits">2</span>
          
          <code class="ruby">		  return &quot;debug&quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="34">
          <span class="hits">2</span>
          
          <code class="ruby">		when &quot;T&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">		  return &quot;trace&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">	else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">		#not testable since u would either need to parse the event to the function or need another 'if' when the method is called. Both cases would influence performance so I would recommend not unit testing the else part</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">		event.set('debuginfo', 'Failed to parse loglevel &lt;' + loglevel + '&gt;')</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">		@logger.warn('Failed to parse loglevel &lt;' + loglevel + '&gt;; message: ' + event.get('message'))</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">		return loglevel</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">	end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end # def getLoglevel</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  public</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">  def filter(event)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">    # return nothing unless there's an actual filter event</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="47">
          <span class="hits">24</span>
          
          <code class="ruby">    return unless filter?(event)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">	#First we extract Timestamp, Computer, Maindealer, Username, Server, ThreadID, Loglevel from the logmessage.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">	#Note that there are many possible combinations of computer, maindealer, username, server and threadID.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">	</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">	#examples:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">	#2017-04-17 21:10:45.876 . S: START C2 Server [bsapplication.cpp:49]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">	#2017-04-17 21:10:45.878 . #19930 I: Booting C2 Server C2SERVER (BSLog) [c2server.cpp:358]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">	#2017-04-17 21:11:44.299 .730.@crapppilot02p #20953 D: Event ADMIN_REFRESH(4) for client (0), dealer 99911 received [iniconsumer.cpp:47]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">	#2017-04-17 21:10:49.693 H0070715.730.@crapppilot02p #20895 I: ClientTraceManager: default dynamic trace time set to 2 hours. [clienttracemanager.cpp:36]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">	#2017-04-18 05:49:07.465 H0073025.730.h730erha@crapppilot02p #20896 I: PoiConnectionpool::GetConnection: Connection aus Pool 730_TEMP (VpdId '730') entnommen [poiconnectionpool.cpp:127]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">	#2017-04-18 05:49:07.465 H0073025.730.h730er@ha@crapppilot02p #20896 I: PoiConnectionpool::GetConnection: Connection aus Pool 730_TEMP (VpdId '730') entnommen [poiconnectionpool.cpp:127]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">	</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">	#multiline example:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">	#2017-04-18 08:28:40.475 H0080008.730.h800ant@crapppilot02p #20936 I: first part</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">	#2017-04-18 08:28:40.475 H0080008.730.h800ant@crapppilot02p #20936 I:   second part</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">	#2017-04-18 08:28:40.475 H0080008.730.h800ant@crapppilot02p #20936 I:   third part</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">	#2017-04-18 08:28:40.475 H0080008.730.h800ant@crapppilot02p #20936 I:   fourth part [channelconfig.cpp:113]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="66">
          <span class="hits">24</span>
          
          <code class="ruby">	if /^([\d]{4}-[\d]{2}-[\d]{2}\s+[\d]{2}:[\d]{2}:[\d]{2}.[\d]{3})\s+([^*]+)$/.match(event.get('message'))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">		# $1 = timestamp</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">		# $2 = message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">		</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="70">
          <span class="hits">23</span>
          
          <code class="ruby">		begin</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="71">
          <span class="hits">23</span>
          
          <code class="ruby">			rubytime = Time.strptime($1, &quot;%Y-%m-%d %H:%M:%S.%L&quot;)</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="72">
          <span class="hits">22</span>
          
          <code class="ruby">			logstash_time = LogStash::Timestamp.new(rubytime)</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="73">
          <span class="hits">22</span>
          
          <code class="ruby">			event.set('@timestamp', logstash_time)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">		rescue Exception =&gt; e  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">			event.set('debuginfo', 'Failed to parse date &lt;' + $1 + '&gt;')</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">			@logger.warn('Failed to parse date &lt;' + $1 + '&gt;; message: ' + e.message + ', stacktrace:' + e.backtrace.inspect)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">		end</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="78">
          <span class="hits">23</span>
          
          <code class="ruby">		event.set('message', $2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">		    </code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="80">
          <span class="hits">23</span>
          
          <code class="ruby">		if /^([^\.]*+)\.([^\.\s]*+)\.?(?:([^\@\s]*+|[^\@\s]*+\@[^\@\s]*+)?\@([^\s\@]*+)?)?\s+\#?([\d]*+)?\s?([^\:]{1})\:\s+([^\[\n]*+)\[([^\]\n]+)\](?:\s+\[([^\]\n]+)\])?/.match(event.get('message'))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">			# $1 = computer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">			# $2 = dealer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">			# $3 = username</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">			# $4 = server</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">			# $5 = threadID</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">			# $6 = loglevel</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">			# $7 = message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="90">
          <span class="hits">21</span>
          
          <code class="ruby">			event.set(&quot;testfield&quot;, &quot;tesst&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="92">
          <span class="hits">21</span>
          
          <code class="ruby">			if not $1 == &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="93">
          <span class="hits">14</span>
          
          <code class="ruby">				event.set('computer', $1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">			end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="96">
          <span class="hits">21</span>
          
          <code class="ruby">			if not $2 == &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="97">
          <span class="hits">19</span>
          
          <code class="ruby">				event.set('dealer', $2.to_i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">			end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="100">
          <span class="hits">21</span>
          
          <code class="ruby">			if not $3 == &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="101">
          <span class="hits">14</span>
          
          <code class="ruby">				event.set('username', $3)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">			end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="104">
          <span class="hits">21</span>
          
          <code class="ruby">			if not $4 == &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="105">
          <span class="hits">21</span>
          
          <code class="ruby">				event.set('server', $4)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">			end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="108">
          <span class="hits">21</span>
          
          <code class="ruby">			if not $5 == &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="109">
          <span class="hits">20</span>
          
          <code class="ruby">				event.set('threadID', $5)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">			end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">					</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="112">
          <span class="hits">21</span>
          
          <code class="ruby">			event.set('loglevel', getLoglevel($6, event))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby">							</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="114">
          <span class="hits">21</span>
          
          <code class="ruby">			event.set('message', $7.strip)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby">					</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="116">
          <span class="hits">21</span>
          
          <code class="ruby">			if $9.nil?</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="117">
          <span class="hits">17</span>
          
          <code class="ruby">				event.set('emitter', $8)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">			else</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="119">
          <span class="hits">4</span>
          
          <code class="ruby">				event.set('emitter', $8 + &quot; &quot; + $9)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">				#we need to delete the last character ( which is a whitespace character) of the message, because for some weird reason, there are two whitespace characters between the message and the two emitters, the regex only backtracks to one whitespace character and succeeds	</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="122">
          <span class="hits">4</span>
          
          <code class="ruby">				event.set('message', event.get('message').strip)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby">			end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby">			#Since the maximum size of a field is 32766 bytes, we need to take care of longer messages </code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="126">
          <span class="hits">21</span>
          
          <code class="ruby">			if event.get('message').bytesize &gt; 32000;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="127">
          <span class="hits">1</span>
          
          <code class="ruby">				event.set('message', event.get('message').byteslice(0, 32000) + &quot;...(TRUNCATED)&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">			end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">						</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">			#FunctionCounter SVNT: BEGIN C2_ExternalService_i&lt;appsrv&gt;::Call(dealer=30200, headquarter=30200, method=ADMIN_REFRESH)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby">			#FunctionCounter SVNT: END   C2_CacheService_i&lt;Service&gt;::ReadLists()|170ms|ATBGHC0316|poiese</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">			#FunctionCounter ZAD: INFO::GetAnzahlOffeneAktivitaeten</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">			#FunctionCounter WEB: VehicleDataAvailability::GetDataAvailability()|918ms</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">			# Extracting the FunctionCounterType -&gt; logtype</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="135">
          <span class="hits">21</span>
          
          <code class="ruby">			if /^FunctionCounter\s+([^:]+):\s+([^\[]+)$/.match(event.get('message'))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">				</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby">				</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="138">
          <span class="hits">4</span>
          
          <code class="ruby">				event.set('logtype', $1)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="139">
          <span class="hits">4</span>
          
          <code class="ruby">				temp = $2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby">				#If there is 'BEGIN' or 'END' at the start of the logline, extract those and add them to the logtype</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">				#BEGIN C2_ExternalService_i&lt;appsrv&gt;::Call(dealer=30200, headquarter=30200, method=ADMIN_REFRESH)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">				#END   C2_CacheService_i&lt;Service&gt;::ReadLists()|170ms|ATBGHC0316|poiese</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby">				# $1                                                                $2		   </code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="144">
          <span class="hits">4</span>
          
          <code class="ruby">				if /^(END|BEGIN)\s+(.*)$/.match(temp)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="145">
          <span class="hits">2</span>
          
          <code class="ruby">					event.set('logtype', event.get('logtype') + &quot; &quot; + $1)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="146">
          <span class="hits">2</span>
          
          <code class="ruby">					temp = $2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby">				end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby">				</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">				#FunctionCounter SVNT: BEGIN  ||  C2_ExternalService_i&lt;appsrv&gt;::Call(dealer=30200, headquarter=30200, method=ADMIN_REFRESH) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby">				#FunctionCounter SVNT: BEGIN  ||  C2_ORBControl_i&lt;Service&gt;::RegisterClient(ATBGHC0316, twe.exe(2288))			</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">				#FunctionCounter ZAD: 		  ||  INFO::GetAnzahlOffeneAktivitaeten</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby">				#FunctionCounter ZAD: 		  ||  DfltGenReadForFAKTAUFTRAG</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="154">
          <span class="hits">4</span>
          
          <code class="ruby">				if [&quot;SVNT BEGIN&quot;, &quot;ZAD&quot;].include? event.get('logtype')</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="155">
          <span class="hits">2</span>
          
          <code class="ruby">					event.set('classNdetail', temp)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby">					</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby">				#FunctionCounter WEB: 		|| 	VehicleDataAvailability::GetDataAvailability()|918ms</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby">				#FunctionCounter SVNT: END 	||	C2_CacheService_i&lt;Service&gt;::ReadLists()|170ms|ATBGHC0316|poiese</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby">				#FunctionCounter SVNT: END 	||	C2_ORBControl_i&lt;Service&gt;::SendClientTrace()|0ms|ATBGHC0478|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby">				#FunctionCounter SVNT: END 	||	C2_ExternalService_i&lt;auf&gt;::Call(dealer=30200, headquarter=30200, method=TERMINERINNERUNGEN)|776ms||	</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby">				else</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="162">
          <span class="hits">2</span>
          
          <code class="ruby">					matcher = /^(?&lt;classNdetail&gt;[^\|]+)\|(?&lt;duration&gt;[\d]+)ms.*$/.match(temp)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="163">
          <span class="hits">2</span>
          
          <code class="ruby">					event.set('classNdetail', matcher[&quot;classNdetail&quot;])</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="164">
          <span class="hits">2</span>
          
          <code class="ruby">					event.set('durationMS', matcher[&quot;duration&quot;].to_f)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="165">
          <span class="hits">2</span>
          
          <code class="ruby">					event.set('durationS', matcher[&quot;duration&quot;].to_f / 1000)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">				end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby">				</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">			#Long Running FOP: 60,061 seconds - H0015519:150:155 - context C2_GuiFacade_i&lt;AUF_GFAuftragsKopf&gt;::Action(ACDruckenAuftrag) - layout kts_auf_auftragsdruck.xsl</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby">			#Long Running PT: 60,701 seconds - H0015519:150:155 - context C2_GuiFacade_i&lt;AUF_GFAuftragsKopf&gt;::Action(ACDruckenAuftrag) - primary threads 3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby">			#Long Running DB: 14,695 seconds - H0015533:150:155 - context C2_GuiFacade_i&lt;MIT_GFZeitstempelung&gt;::Action(action_stempeln) - DBOraConnection::ExecuteStatement (ZEITSTEMPELKORR) - select max(lfdnr) from zeitstempelkorr where mandantnr = :P0  and modulnr = :P1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby">			#Long Running ST: 6,013 seconds - H0019945:150:199 - context C2_GuiFacade_i&lt;AUF_GFAuftragsKopf&gt;::AsyncThread(ACCallCarportAsync) - secondary threads 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby">			# check if we have a long running and extract type (primary/secondary thread, database, fopper) and duration from the log</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby">			elsif /^(?&gt;Long\sRunning)\s([^\:]+)\:\s([\d\,]+)\s[^\-]+\-[^\-]+\-\s[^\s]+\s([^\)]+\))\s\-\s(.*)/.match(event.get('message'))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby">				# $1 = Type (PT|ST|FOP|DB)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby">				# $2 = duration [s]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby">				# $3 = details for workstation, maindealer and dealer (not required as at least workstation name and maindealer are already set)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby">				# $4 = class</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby">				# $5 = detail</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby">				# $6 = message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="182">
          <span class="hits">4</span>
          
          <code class="ruby">				event.set('logtype', $1)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="183">
          <span class="hits">4</span>
          
          <code class="ruby">				event.set('classNdetail', $3)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="185">
          <span class="hits">4</span>
          
          <code class="ruby">				temp = $4</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby">				# convert the duration to a float value -- do this as last statement otherwise the $1, $2, ... will be reset</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="187">
          <span class="hits">4</span>
          
          <code class="ruby">				event.set('durationS', $2.to_s.gsub(&quot;,&quot;, &quot;.&quot;).to_f)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="188">
          <span class="hits">8</span>
          
          <code class="ruby">				event.set('durationMS', (event.get('durationS') * 1000).to_f)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby">				</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="190">
          <span class="hits">4</span>
          
          <code class="ruby">				if event.get('logtype') == &quot;PT&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="191">
          <span class="hits">1</span>
          
          <code class="ruby">					matcher = /^primary\sthreads\s(?&lt;quantity&gt;[\d]+)$/.match(temp)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="192">
          <span class="hits">1</span>
          
          <code class="ruby">					event.set('quantity', matcher[&quot;quantity&quot;].to_i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby">				elsif event.get('logtype') == &quot;ST&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="194">
          <span class="hits">1</span>
          
          <code class="ruby">					matcher = /^secondary\sthreads\s(?&lt;quantity&gt;[\d]+)$/.match(temp)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="195">
          <span class="hits">1</span>
          
          <code class="ruby">					event.set('quantity', matcher[&quot;quantity&quot;].to_i)					</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby">				end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">						</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby">			#PoiConnPoolCat::ReleaseOCISession Oci=164746912 Max=20 Open=1 Used=0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="199">
          
          
          <code class="ruby">			elsif /^(PoiConnPoolCat\:\:ReleaseOCISession)\sOci\=(-?[\d]+)\sMax\=([\d]+)\sOpen\=([\d]+)\sUsed\=([\d]+)$/.match(event.get('message'))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="201">
          <span class="hits">1</span>
          
          <code class="ruby">				event.set('logtype', &quot;DBI&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="202">
          <span class="hits">1</span>
          
          <code class="ruby">				event.set('classNdetail', $1)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="203">
          <span class="hits">1</span>
          
          <code class="ruby">				event.set('oci_ID', $2.to_i)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="204">
          <span class="hits">1</span>
          
          <code class="ruby">				event.set('maxConnections', $3.to_i)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="205">
          <span class="hits">1</span>
          
          <code class="ruby">				event.set('openConnections', $4.to_i)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="206">
          <span class="hits">1</span>
          
          <code class="ruby">				event.set('usedConnections', $5.to_i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby">				</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby">			#PoiConnPoolCat::GetConnection: 730_BACK Oci=0 Max=20 Open=1 Used=1 (5%)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby">			elsif /^(PoiConnPoolCat\:\:GetConnection)\:\s(([\d]+)\_[^\s]+|[^\s]+)\sOci\=(-?[\d]+)\sMax\=([\d]+)\sOpen\=([\d]+)\sUsed\=([\d]+)\s.*$/.match(event.get('message'))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="211">
          <span class="hits">1</span>
          
          <code class="ruby">					event.set('logtype', &quot;DBI&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="212">
          <span class="hits">1</span>
          
          <code class="ruby">					event.set('classNdetail', $1)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="213">
          <span class="hits">1</span>
          
          <code class="ruby">					event.set('connectionPool', $2)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="214">
          <span class="hits">1</span>
          
          <code class="ruby">					event.set('vpdid', $3.to_i)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="215">
          <span class="hits">1</span>
          
          <code class="ruby">					event.set('oci_ID', $4.to_i)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="216">
          <span class="hits">1</span>
          
          <code class="ruby">					event.set('maxConnections', $5.to_i)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="217">
          <span class="hits">1</span>
          
          <code class="ruby">					event.set('openConnections', $6.to_i)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="218">
          <span class="hits">1</span>
          
          <code class="ruby">					event.set('usedConnections', $7.to_i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">			#PoiConnectionpool::GetConnection: Connection aus Pool 730_BACK (VpdId '730') entnommen</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby">			elsif /^(PoiConnectionpool\:\:GetConnection)\:\s[^\d]+([\d]+\_[^\s]+|[^\d\s]+)\s\([^\']+\'([^\']*)\'\)/.match(event.get('message'))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="223">
          <span class="hits">1</span>
          
          <code class="ruby">				event.set('logtype', &quot;DBI&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="224">
          <span class="hits">1</span>
          
          <code class="ruby">				event.set('classNdetail', $1)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="225">
          <span class="hits">1</span>
          
          <code class="ruby">				event.set('connectionPool', $2)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="226">
          <span class="hits">1</span>
          
          <code class="ruby">				event.set('vpdid', $3.to_i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby">			else</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="228">
          <span class="hits">10</span>
          
          <code class="ruby">				if event.get('debuginfo') == NIL</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="229">
          <span class="hits">8</span>
          
          <code class="ruby">					event.set('debuginfo', &quot;message not defined&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby">				end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby">			end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby">		</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby">		elsif /^([^\.]*+)\.([^\.\s]*+)\.?(?:([^\@\s]*+|[^\@\s]*+\@[^\@\s]*+)?\@([^\s\@]+)?)?\s+\#?([\d]*+)?\s?([^\:]{1})\:\s+([^*]+)\[([^\]\n]+)\]$/.match(event.get('message'))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="234">
          
          
          <code class="ruby">			# $1 = computer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="235">
          
          
          <code class="ruby">			# $2 = dealer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="236">
          
          
          <code class="ruby">			# $3 = username</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">			# $4 = server</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby">			# $5 = threadID</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby">			# $6 = loglevel</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby">			# $7 = message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="241">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="242">
          <span class="hits">1</span>
          
          <code class="ruby">			if not $1 == &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="243">
          <span class="hits">1</span>
          
          <code class="ruby">				event.set('computer', $1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="244">
          
          
          <code class="ruby">			end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="245">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="246">
          <span class="hits">1</span>
          
          <code class="ruby">			if not $2 == &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="247">
          <span class="hits">1</span>
          
          <code class="ruby">				event.set('dealer', $2.to_i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="248">
          
          
          <code class="ruby">			end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="249">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="250">
          <span class="hits">1</span>
          
          <code class="ruby">			if not $3 == &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="251">
          <span class="hits">1</span>
          
          <code class="ruby">				event.set('username', $3)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="252">
          
          
          <code class="ruby">			end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="253">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="254">
          <span class="hits">1</span>
          
          <code class="ruby">			if not $4 == &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="255">
          <span class="hits">1</span>
          
          <code class="ruby">				event.set('server', $4)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="256">
          
          
          <code class="ruby">			end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="257">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="258">
          <span class="hits">1</span>
          
          <code class="ruby">			if not $5 == &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="259">
          <span class="hits">1</span>
          
          <code class="ruby">				event.set('threadID', $5)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="260">
          
          
          <code class="ruby">			end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="262">
          <span class="hits">1</span>
          
          <code class="ruby">			event.set('loglevel', getLoglevel($6, event))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="263">
          
          
          <code class="ruby">						</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="264">
          <span class="hits">1</span>
          
          <code class="ruby">			event.set('message', $7.strip)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="265">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="266">
          <span class="hits">1</span>
          
          <code class="ruby">			if $9.nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="267">
          <span class="hits">1</span>
          
          <code class="ruby">				event.set('emitter', $8)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="268">
          
          
          <code class="ruby">			else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="269">
          
          
          <code class="ruby">				event.set('emitter', $8 + &quot; &quot; + $9)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="270">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="271">
          
          
          <code class="ruby">				#we need to delete the last character ( which is a whitespace character) of the message, because for some weird reason, there are two whitespace characters between the message and the two emitters, the regex only backtracks to one whitespace character and succeeds	</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="272">
          
          
          <code class="ruby">				event.set('message', event.get('message').chomp(' '))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="273">
          
          
          <code class="ruby">			end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="274">
          
          
          <code class="ruby">				</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="275">
          <span class="hits">1</span>
          
          <code class="ruby">			event.set('message', event.get('message').gsub(/^[\d]{4}-[\d]{2}-[\d]{2}\s+[\d]{2}:[\d]{2}:[\d]{2}.[\d]{3}\s+[^\s]*+\s+\#?[\d]*+\s?[^\:]{1}\:\s+/, ''))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="276">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="277">
          
          
          <code class="ruby">			#Since the maximum size of a field is 32766 bytes, we need to take care of longer messages </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="278">
          <span class="hits">1</span>
          
          <code class="ruby">			if event.get('message').bytesize &gt; 32000;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="279">
          
          
          <code class="ruby">				event.set('message', event.get('message').byteslice(0, 32000) + &quot;...(TRUNCATED)&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby">			end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="281">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="282">
          <span class="hits">1</span>
          
          <code class="ruby">			if /^(?&gt;Long\sRunning)\s([^\:]+)\:\s([\d\,]+)\s[^\-]+\-[^\-]+\-\s[^\s]+\s([^\)]+\))\s\-\s(.*)/.match(event.get('message'))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="283">
          
          
          <code class="ruby">				# $1 = Type (PT|ST|FOP|DB)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="284">
          
          
          <code class="ruby">				# $2 = duration [s]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="285">
          
          
          <code class="ruby">				# $3 = details for workstation, maindealer and dealer (not required as at least workstation name and maindealer are already set)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="286">
          
          
          <code class="ruby">				# $4 = class</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="287">
          
          
          <code class="ruby">				# $5 = detail</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="288">
          
          
          <code class="ruby">				# $6 = message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="289">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="290">
          
          
          <code class="ruby">				event.set('logtype', $1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="291">
          
          
          <code class="ruby">				event.set('classNdetail', $3)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="292">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="293">
          
          
          <code class="ruby">				temp = $4</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="294">
          
          
          <code class="ruby">				# convert the duration to a float value -- do this as last statement otherwise the $1, $2, ... will be reset</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="295">
          
          
          <code class="ruby">				event.set('durationS', $2.to_s.gsub(&quot;,&quot;, &quot;.&quot;).to_f)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="296">
          
          
          <code class="ruby">				event.set('durationMS', (event.get('durationS') * 1000).to_f)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="297">
          
          
          <code class="ruby">				</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="298">
          
          
          <code class="ruby">				if event.get('logtype') == &quot;PT&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="299">
          
          
          <code class="ruby">					matcher = /^primary\sthreads\s(?&lt;quantity&gt;[\d]+)$/.match(temp)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="300">
          
          
          <code class="ruby">					event.set('quantity', matcher[&quot;quantity&quot;].to_i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="301">
          
          
          <code class="ruby">				elsif event.get('logtype') == &quot;ST&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="302">
          
          
          <code class="ruby">					matcher = /^secondary\sthreads\s(?&lt;quantity&gt;[\d]+)$/.match(temp)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="303">
          
          
          <code class="ruby">					event.set('quantity', matcher[&quot;quantity&quot;].to_i)					</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="304">
          
          
          <code class="ruby">				end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="305">
          
          
          <code class="ruby">			end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="306">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="307">
          
          
          <code class="ruby">		else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="308">
          <span class="hits">1</span>
          
          <code class="ruby">			event.set('debuginfo', &quot;bad format, timestamp OK&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="309">
          
          
          <code class="ruby">		end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="310">
          
          
          <code class="ruby">	else </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="311">
          <span class="hits">1</span>
          
          <code class="ruby">		if event.get('debuginfo') == NIL</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="312">
          <span class="hits">1</span>
          
          <code class="ruby">			event.set('debuginfo', &quot;failed to match timestamp&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="313">
          
          
          <code class="ruby">		end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="314">
          
          
          <code class="ruby">	end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="315">
          
          
          <code class="ruby">			</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="316">
          <span class="hits">24</span>
          
          <code class="ruby">    filter_matched(event)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="317">
          
          
          <code class="ruby">	</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="318">
          
          
          <code class="ruby">  end # def filter</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="319">
          
          
          <code class="ruby">end # class LogStash::Filters::Foo</code>
        </li>
      
    </ol>
  </pre>
</div>

      
      </div>
    </div>
  </body>
</html>
